<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Geo Circle KML Generator</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
            background-color: #f8f8f8;
        }
        h1 {
            text-align: center;
            color: #333;
        }
        form {
            background: #fff;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.2);
            max-width: 600px;
            margin: auto;
        }
        input, select, button {
            display: block;
            width: 100%;
            padding: 10px;
            margin: 10px 0;
            border: 1px solid #ddd;
            border-radius: 5px;
        }
        button {
            background-color: #007BFF;
            color: white;
            font-size: 16px;
            border: none;
        }
        button:hover {
            background-color: #0056b3;
        }
    </style>
</head>
<body>
    <h1>Geo Circle KML Generator</h1>
    <form id="kmlForm">
        <label for="name">Business Name:</label>
        <input type="text" id="name" placeholder="Enter Business Name" required>

        <label for="coordinates">Business Coordinates (lat,lng):</label>
        <input type="text" id="coordinates" placeholder="Example: 26.2508, 82.9441" required>

        <label for="description">Business Description:</label>
        <input type="text" id="description" placeholder="Enter Description">

        <label for="keywords">Keywords (comma separated):</label>
        <input type="text" id="keywords" placeholder="Keyword1, Keyword2, Keyword3, etc.">

        <label for="radius">Select Radius and Number of Circles:</label>
        <select id="radius">
            <option value="5,1">5 Km - 1 Circle</option>
            <option value="10,2">10 Km - 2 Circles</option>
            <option value="15,3">15 Km - 3 Circles</option>
            <option value="30,6">30 Km - 6 Circles</option>
            <option value="50,10">50 Km - 10 Circles</option>
            <option value="100,20">100 Km - 20 Circles</option>
        </select>

        <button type="button" onclick="generateKML()">Generate KML</button>
    </form>

    <script>
        function generateKML() {
            const name = document.getElementById('name').value;
            const coordinates = document.getElementById('coordinates').value.split(',');
            const description = document.getElementById('description').value;
            const keywords = document.getElementById('keywords').value;
            const radiusOption = document.getElementById('radius').value.split(',');

            if (coordinates.length !== 2) {
                alert('Please enter valid coordinates: latitude and longitude.');
                return;
            }

            const centerLat = parseFloat(coordinates[0].trim());
            const centerLng = parseFloat(coordinates[1].trim());
            const radiusInKm = parseFloat(radiusOption[0]);
            const numCircles = parseInt(radiusOption[1]);

            let kmlContent = `<?xml version="1.0" encoding="UTF-8"?>
<kml xmlns="http://www.opengis.net/kml/2.2">
<Document>
    <name>${name} - Circles</name>
    <description>${description}</description>
    <keywords>${keywords}</keywords>
`;

            // Generate circles
            const earthRadius = 6371; // Earth's radius in kilometers
            for (let i = 1; i <= numCircles; i++) {
                const currentRadius = radiusInKm * i; // Adjust radius for each circle
                let coordinatesStr = '';

                for (let angle = 0; angle < 360; angle++) {
                    const bearing = (angle * Math.PI) / 180; // Convert to radians
                    const lat = Math.asin(
                        Math.sin(degToRad(centerLat)) * Math.cos(currentRadius / earthRadius) +
                        Math.cos(degToRad(centerLat)) * Math.sin(currentRadius / earthRadius) * Math.cos(bearing)
                    );
                    const lng = degToRad(centerLng) + Math.atan2(
                        Math.sin(bearing) * Math.sin(currentRadius / earthRadius) * Math.cos(degToRad(centerLat)),
                        Math.cos(currentRadius / earthRadius) - Math.sin(degToRad(centerLat)) * Math.sin(lat)
                    );

                    coordinatesStr += `${radToDeg(lng)},${radToDeg(lat)},0\n`;
                }

                kmlContent += `
    <Placemark>
        <name>Circle ${i} (${currentRadius} Km)</name>
        <Polygon>
            <outerBoundaryIs>
                <LinearRing>
                    <coordinates>
                        ${coordinatesStr}
                    </coordinates>
                </LinearRing>
            </outerBoundaryIs>
        </Polygon>
    </Placemark>
`;
            }

            kmlContent += `</Document></kml>`;

            // Download KML
            const blob = new Blob([kmlContent], { type: 'application/vnd.google-earth.kml+xml' });
            const link = document.createElement('a');
            link.href = URL.createObjectURL(blob);
            link.download = `${name}_circles.kml`;
            link.click();
        }

        function degToRad(degrees) {
            return degrees * (Math.PI / 180);
        }

        function radToDeg(radians) {
            return radians * (180 / Math.PI);
        }
    </script>
</body>
</html>
