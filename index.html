<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Geo Circle KML Generator</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 20px;
            background-color: #f4f4f9;
        }
        h1 {
            text-align: center;
        }
        form {
            max-width: 500px;
            margin: 0 auto;
            background: #fff;
            padding: 20px;
            box-shadow: 0px 0px 10px rgba(0,0,0,0.1);
            border-radius: 8px;
        }
        label {
            display: block;
            margin: 10px 0 5px;
            font-weight: bold;
        }
        input, select, textarea {
            width: 100%;
            padding: 8px;
            margin-bottom: 10px;
            border: 1px solid #ddd;
            border-radius: 5px;
            box-sizing: border-box;
        }
        button {
            background-color: #007BFF;
            color: #fff;
            padding: 10px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
        }
        button:hover {
            background-color: #0056b3;
        }
    </style>
</head>
<body>
    <h1>Geo Circle KML Generator</h1>
    <form id="circleForm">
        <label for="name">Business Name</label>
        <input type="text" id="name" required>

        <label for="coordinates">Business Coordinates (lat, lng)</label>
        <input type="text" id="coordinates" placeholder="e.g., 26.250787, 82.944086" required>

        <label for="description">Business Description</label>
        <textarea id="description" rows="3"></textarea>

        <label for="keyword1">Keyword 1</label>
        <input type="text" id="keyword1" required>

        <label for="keyword2">Keyword 2</label>
        <input type="text" id="keyword2" required>

        <label for="keyword3">Keyword 3</label>
        <input type="text" id="keyword3" required>

        <label for="keyword4">Keyword 4</label>
        <input type="text" id="keyword4" required>

        <label for="keyword5">Keyword 5</label>
        <input type="text" id="keyword5" required>

        <label for="radius">Choose Radius and Number of Circles</label>
        <select id="radius">
            <option value="5,1">5 Km - 1 Circle</option>
            <option value="10,2">10 Km - 2 Circles</option>
            <option value="15,3">15 Km - 3 Circles</option>
            <option value="30,6">30 Km - 6 Circles</option>
            <option value="50,10">50 Km - 10 Circles</option>
            <option value="100,20">100 Km - 20 Circles</option>
        </select>

        <button type="button" onclick="generateKML()">Generate Downloadable KML</button>
    </form>

    <script>
        function generateKML() {
            const businessName = document.getElementById("name").value;
            const coordinates = document.getElementById("coordinates").value.split(",");
            const description = document.getElementById("description").value;
            const keywords = [
                document.getElementById("keyword1").value,
                document.getElementById("keyword2").value,
                document.getElementById("keyword3").value,
                document.getElementById("keyword4").value,
                document.getElementById("keyword5").value
            ];
            const radiusInfo = document.getElementById("radius").value.split(",");
            const centerLat = parseFloat(coordinates[0].trim());
            const centerLng = parseFloat(coordinates[1].trim());
            const numCircles = parseInt(radiusInfo[1]);
            const circleRadius = parseInt(radiusInfo[0]) * 1000; // convert to meters

            let kmlData = `<?xml version="1.0" encoding="UTF-8"?>\n`;
            kmlData += `<kml xmlns="http://www.opengis.net/kml/2.2">\n<Document>\n`;
            kmlData += `<name>${businessName} Geo Circles</name>\n`;

            let keywordIndex = 0;

            for (let i = 1; i <= numCircles; i++) {
                const currentRadius = circleRadius * i;
                for (let j = 0; j < 360; j++) {
                    const angle = (j * Math.PI) / 180; // Convert to radians
                    const lat = centerLat + (currentRadius / 111320) * Math.cos(angle);
                    const lng = centerLng + (currentRadius / (111320 * Math.cos(centerLat * Math.PI / 180))) * Math.sin(angle);

                    const currentKeyword = keywords[keywordIndex % keywords.length];
                    keywordIndex++;

                    kmlData += `<Placemark>\n`;
                    kmlData += `<name>${businessName} - ${currentKeyword}</name>\n`;
                    kmlData += `<description>${description}</description>\n`;
                    kmlData += `<Point>\n<coordinates>${lng},${lat},0</coordinates>\n</Point>\n`;
                    kmlData += `</Placemark>\n`;
                }
            }

            kmlData += `</Document>\n</kml>`;

            // Download the KML file
            const blob = new Blob([kmlData], { type: "application/vnd.google-earth.kml+xml" });
            const link = document.createElement("a");
            link.href = URL.createObjectURL(blob);
            link.download = `${businessName}_geo_circles.kml`;
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
        }
    </script>
</body>
</html>
